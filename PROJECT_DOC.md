# Документация по использованию JSON-данных в проекте SkillSwap

## Оглавление

1. [Общее описание](#общее-описание)
2. [Назначение и структура JSON-файлов](#назначение-и-структура-json-файлов)
3. [Использование данных для реализации функционала](#использование-данных-для-реализации-функционала)
4. [Связи между сущностями](#связи-между-сущностями)
5. [Рекомендации по работе с данными](#рекомендации-по-работе-с-данными)

---

## Общее описание

SkillSwap — платформа для обмена навыками между пользователями. Все основные данные приложения хранятся в JSON-файлах в папке `public/db`. Эти данные используются для отображения каталога навыков, профилей пользователей, фильтрации, лайков, заявок на обмен и других функций.

---

## Назначение и структура JSON-файлов

### 1. users.json / user.json

- **users.json** — основной справочник всех пользователей платформы.
- **user.json** — массив пользователей, от лица которых можно авторизоваться (структура идентична users.json, но содержит email и password).
- **Структура пользователя:**
  - `id`: уникальный идентификатор пользователя
  - `name`: имя
  - `email`, `password`: только для авторизуемых пользователей
  - `avatarUrl`: ссылка на аватар
  - `birthDate`: дата рождения (ISO-строка)
  - `genderId`: id пола (из gender.json)
  - `locationId`: id города (из city.json)
  - `description`: описание профиля
  - `createdAt`: дата регистрации
  - `skillsCanTeach`: массив объектов (навыки, которыми пользователь может делиться)
    - `subcategoryId`: id подкатегории (из skills.json)
    - `description`: описание навыка
    - `images`: массив ссылок на иллюстрации
  - `skillsWantToLearn`: массив id подкатегорий (из skills.json)

### 2. skills.json

- Справочник всех категорий и подкатегорий навыков.
- **Структура:**
  - `id`: id категории
  - `name`: название категории
  - `icon`: путь к иконке
  - `color`: цвет категории
  - `skills`: массив подкатегорий
    - `id`: id подкатегории
    - `name`: название подкатегории
    - (опционально) `description`, `image`

### 3. city.json

- Справочник городов.
- **Структура:**
  - `id`: id города
  - `city-name`: название города

### 4. gender.json

- Справочник вариантов пола.
- **Структура:**
  - `id`: id пола
  - `label`: отображаемое название

### 5. likes.json

- Хранит информацию о лайках между пользователями.
- **Структура:**
  - `userId`: кто поставил лайк
  - `targetUserId`: кому поставлен лайк
  - `createdAt`: дата лайка

### 6. request-statuses.json

- Справочник статусов заявок на обмен.
- **Структура:**
  - `id`: id статуса
  - `code`: строковый код статуса
  - `label`: отображаемое название

### 7. requests.json

- Хранит заявки на обмен навыками между пользователями.
- **Структура:**
  - `id`: id заявки
  - `skillId`: id подкатегории навыка (из skills.json)
  - `fromUserId`: id пользователя, отправившего заявку
  - `toUserId`: id пользователя, которому отправлена заявка
  - `statusId`: id статуса (из request-statuses.json)
  - `createdAt`: дата создания
  - `finishedAt`: дата завершения (или null)

---

## Использование данных для реализации функционала

### Каталог навыков и фильтрация

- Для отображения каталога используются users.json и skills.json.
- Фильтрация по категориям, подкатегориям, полу, городу реализуется через id (locationId, genderId, subcategoryId).
- Для отображения названий и иконок категорий/подкатегорий используются skills.json.
- Для отображения города и пола — city.json и gender.json.

### Профиль пользователя

- Данные профиля берутся из users.json (или user.json для авторизованного пользователя).
- Навыки, которыми пользователь может делиться, отображаются из массива skillsCanTeach (по subcategoryId ищется название и категория в skills.json).
- Навыки, которым пользователь хочет научиться, отображаются по массиву skillsWantToLearn (по id ищется название в skills.json).

### Лайки и избранное

- likes.json хранит пары userId → targetUserId.
- Для отображения количества лайков пользователя — считаются все записи, где targetUserId равен id пользователя.
- Для отображения избранного пользователя (кому он поставил лайк) — фильтруются записи, где userId равен id текущего пользователя.
- Избранное также может храниться в localStorage для быстрого доступа.

### Заявки на обмен (requests)

- requests.json хранит все заявки между пользователями.
- Для отображения входящих/исходящих заявок пользователя — фильтруются по fromUserId и toUserId.
- Для отображения статуса заявки — по statusId ищется label в request-statuses.json.
- Для отображения истории и завершённых обменов — фильтруются заявки со статусом done и заполненным finishedAt.

### Страница навыка

- При переходе на /skill/:id используется skillId (subcategoryId) для поиска информации о навыке в skills.json и пользователей, у которых этот навык есть в skillsCanTeach.
- Для related-блока (похожие навыки) — ищутся навыки из той же категории.

### Аутентификация

- Для входа используются данные из user.json (email, password).
- После успешного входа данные пользователя могут храниться в localStorage/sessionStorage.

### Форма создания навыка

- Для выбора категории и подкатегории используются skills.json.
- Для выбора города и пола — city.json и gender.json.
- После создания новый навык добавляется в skillsCanTeach пользователя и сохраняется в users.json (или в localStorage для mock-режима).

### Избранное (favorites)

- Список избранного пользователя формируется на основе likes.json (или localStorage).
- Для отображения карточек избранных пользователей используются их id из likes.json и данные из users.json.

### Заявки (requests)

- Для создания заявки формируется новая запись в requests.json с уникальным id, skillId, fromUserId, toUserId, statusId = 1 (pending), createdAt.
- Для изменения статуса заявки (принять, отклонить, завершить) обновляется поле statusId и, если завершена, finishedAt.

---

## Связи между сущностями

- Все связи между пользователями, навыками, городами, полом и заявками реализуются через id.
- Для отображения человекочитаемых названий, иконок, цветов и т.д. всегда используется соответствующий справочник (skills.json, city.json, gender.json, request-statuses.json).
- Это обеспечивает целостность, масштабируемость и простоту поддержки данных.

---

## Рекомендации по работе с данными

- Всегда использовать id для поиска и фильтрации, а не строки.
- Для отображения информации в UI использовать справочники (skills.json, city.json, gender.json, request-statuses.json).
- Для хранения временных пользовательских данных (избранное, заявки, настройки) использовать localStorage.
- Для расширения функционала (например, добавления тегов, приоритетов, комментариев) расширять соответствующие объекты, не дублируя данные.
- При изменении справочников (skills, city, gender, statuses) не требуется миграция users.json, если используются только id.

---
